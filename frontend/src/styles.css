/* =========================================
   PREMIUM THEME VARIABLES
   ========================================= */
:root {
  /* Font Stack Modern & Internasional */
  --font: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;

  /* --- Dark Theme (Default Premium) --- */
  --bg: #0F1115; /* Hitam pekat dengan sedikit tone biru */
  --bg-gradient: linear-gradient(180deg, #0F1115 0%, #16181D 100%); /* Gradasi halus */
  
  --text: #F3F4F6; /* Putih lembut, tidak menyilaukan */
  --muted: #9CA3AF; /* Abu-abu elegan */

  /* Warna Aksen Utama (Bisa diganti Emas/Perunggu untuk kesan mewah lain) */
  --primary: #3B82F6; /* Royal Blue modern */
  --primary-soft: rgba(59, 130, 246, 0.15);

  --border: rgba(255, 255, 255, 0.08);
  
  /* Glassmorphism Panels */
  --panel-glass: rgba(20, 22, 28, 0.85); /* Panel semi-transparan gelap */
  --blur-strength: 12px;

  /* Bot Bubbles */
  --botBubbleBg: rgba(255, 255, 255, 0.07); /* Sangat subtle */
  --botBorder: rgba(255, 255, 255, 0.05);

  /* User Bubbles */
  --userBubbleBg: var(--primary);
  --userBorder: transparent; /* User bubble modern biasanya tanpa border */
  --userText: #ffffff;

  /* Chips / Tombol Pilihan */
  --chipBg: transparent;
  --chipBorder: rgba(255, 255, 255, 0.2);
  --chipText: var(--text);
  --chipHover: var(--primary-soft);
  --chipBorderHover: var(--primary);

  /* Shadows yang sangat lembut (Soft Elevation) */
  --shadow-sm: 0 2px 8px rgba(0, 0, 0, 0.2);
  --shadow-md: 0 8px 24px rgba(0, 0, 0, 0.25);
}

/* --- Light Theme (Clean & Airy) --- */
:root[data-theme="light"] {
  --bg: #F9FAFB; /* Abu-abu sangat terang, bukan putih bersih */
  --bg-gradient: linear-gradient(180deg, #FFFFFF 0%, #F3F4F6 100%);

  --text: #111827; /* Hampir hitam */
  --muted: #6B7280;

  --primary: #2563EB; /* Biru yang sedikit lebih terang */
  --primary-soft: rgba(37, 99, 235, 0.1);

  --border: rgba(0, 0, 0, 0.08);

  --panel-glass: rgba(255, 255, 255, 0.9);
  
  --botBubbleBg: #FFFFFF;
  --botBorder: rgba(0, 0, 0, 0.04);

  --userBubbleBg: var(--primary);
  --userBorder: transparent;
  --userText: #ffffff;

  --chipBg: transparent;
  --chipBorder: rgba(0, 0, 0, 0.15);
  --chipText: var(--text);
  --chipHover: var(--primary-soft);
  --chipBorderHover: var(--primary);

  --shadow-sm: 0 2px 8px rgba(0, 0, 0, 0.05);
  --shadow-md: 0 8px 24px rgba(0, 0, 0, 0.08);
}

/* =========================================
   BASE STYLES
   ========================================= */
* { box-sizing: border-box; }
html, body { height: 100%; }

body {
  margin: 0;
  background: var(--bg); /* Fallback */
  background-image: var(--bg-gradient); /* Background premium */
  color: var(--text);
  font-family: var(--font);
  -webkit-font-smoothing: antialiased; /* Penting untuk font terlihat tajam di Mac/iOS */
  font-size: 15px; /* Ukuran font standar internasional sedikit lebih besar */
  line-height: 1.6;
  transition: background 0.3s ease, color 0.3s ease;
}

a {
  color: var(--primary);
  text-decoration: none;
  font-weight: 600;
  transition: opacity 0.2s;
}
a:hover { opacity: 0.8; }

/* =========================================
   LAYOUT & CONTAINER
   ========================================= */
#app {
  max-width: 500px; 
  margin: 0 auto;
  height: 100vh;
  height: 100dvh; 
  display: flex;
  flex-direction: column;
  background: transparent; 
  position: relative;
  box-shadow: var(--shadow-md); 
  animation: appEntrance 0.6s cubic-bezier(0.22, 1, 0.36, 1);
}

/* =========================================
   PREMIUM GLASS HEADER
   ========================================= */
.header {
  padding: 10px 16px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  
  /* Efek Kaca (Glassmorphism) */
  background-color: var(--panel-glass);
  backdrop-filter: blur(var(--blur-strength));
  -webkit-backdrop-filter: blur(var(--blur-strength));
  border-bottom: 1px solid var(--border);
  
  position: absolute; /* Sticky di atas */
  top: 0;
  left: 0;
  right: 0;
  z-index: 10;
  min-height: 56px;
}

.header-actions {
  display: flex;
  align-items: center;
  gap: 10px;
}

.brand { 
  font-weight: 700; 
  font-size: 15px; 
  letter-spacing: -0.3px; }

.sub { 
  color: var(--muted); 
  font-size: 12px; 
  font-weight: 500; 
  margin-top: 0; 
}

.icon-btn {
  border: none;
  background: rgba(128, 128, 128, 0.1); /* Tombol transparan halus */
  color: var(--text);
  border-radius: 50%; /* Bulat sempurna */
  width: 36px; height: 36px;
  display: flex; align-items: center; justify-content: center;
  cursor: pointer;
  transition: background 0.2s;
}
.icon-btn svg {
  width: 20px; 
  height: 20px;
  stroke: currentColor;
  stroke-width: 2;
  fill: none;
  stroke-linecap: round;
  stroke-linejoin: round;
}
.icon-btn:hover { background: rgba(128, 128, 128, 0.2); }
.icon-btn:active { transform: scale(0.95); }

/* =========================================
   CHAT AREA
   ========================================= */
.chat {
  padding: 66px 16px 20px 16px; /* Padding atas besar agar tidak tertutup header */
  flex: 1;
  overflow-y: auto;
  scroll-behavior: smooth;
  /* Menyembunyikan scrollbar tapi tetap bisa di-scroll */
  scrollbar-width: none; 
  -ms-overflow-style: none;
}
.chat::-webkit-scrollbar { display: none; }

/* =========================================
   BUBBLES & ANIMATIONS
   ========================================= */
.row {
  margin: 16px 0; /* Jarak antar pesan lebih lega */
  display: flex;
  animation: premiumFadeIn 0.3s cubic-bezier(0.25, 0.8, 0.25, 1); /* Animasi masuk yang halus */
}
@keyframes premiumFadeIn {
  from { opacity: 0; transform: translateY(10px) scale(0.98); }
  to   { opacity: 1; transform: translateY(0) scale(1); }
}

@keyframes appEntrance {
  from {
    opacity: 0;
    transform: translateY(20px) scale(0.98); /* Mulai agak di bawah dan sedikit kecil */
  }
  to {
    opacity: 1;
    transform: translateY(0) scale(1); /* Posisi normal */
  }
}

.row.bot { align-items: flex-end; gap: 12px; } /* Avatar di bawah */
.row.user { flex-direction: column; align-items: flex-end; }

.avatar {
  width: 32px; height: 32px;
  border-radius: 50%;
  flex: 0 0 auto;
  box-shadow: var(--shadow-sm);
  border: 2px solid var(--bg); /* Border halus agar menyatu */
}

.bubble {
  width: fit-content;
  padding: 12px 18px; /* Padding lebih besar dan nyaman */
  border-radius: 20px; /* Sangat bulat (modern) */
  font-size: 15px;
  max-width: 82%;
  line-height: 1.5;
  position: relative;
  word-break: break-word;
}

/* Bot Bubble: Clean & Subtle */
.row.bot .bubble {
  background: var(--botBubbleBg);
  border: 1px solid var(--botBorder);
  box-shadow: var(--shadow-sm);
  border-bottom-left-radius: 4px; /* Sudut kecil di dekat avatar */
}

/* User Bubble: Vibrant & Prominent */
.row.user .bubble {
  background: var(--userBubbleBg);
  color: var(--userText);
  box-shadow: var(--shadow-sm);
  border-bottom-right-radius: 4px;
  border: none; /* Hapus border untuk user agar terlihat modern */
}

.status {
  margin-top: 6px;
  font-size: 11px; font-weight: 500;
  color: var(--muted);
  padding-right: 8px;
  opacity: 0.8;
}
.status.error { color: #EF4444; }

.chat-image {
  width: 100%; max-width: 400px;
  border-radius: 18px;
  display: block;
  border: 1px solid var(--border);
  box-shadow: var(--shadow-md);
}

/* =========================================
   PREMIUM CHIPS (Tombol Pilihan)
   ========================================= */
.chips-row {
  padding-left: 0;
  align-items: flex-end;
}
.chips {
  display: flex; flex-wrap: wrap; gap: 8px;
}

.btn {
  appearance: none;
  display: inline-flex; align-items: center; justify-content: center;
  
  /* Gaya Pill-Shape Outline */
  border: 1px solid var(--chipBorder);
  background: var(--chipBg);
  color: var(--chipText);
  
  padding: 8px 16px; /* Lebih ramping */
  border-radius: 999px; /* Pill shape */
  
  cursor: pointer;
  font-weight: 600; font-size: 13px;
  transition: all 0.2s ease;
  backdrop-filter: blur(4px); /* Efek kaca halus pada tombol */
}

.btn:hover {
  border-color: var(--chipBorderHover);
  background: var(--chipHover);
  transform: translateY(-1px);
  box-shadow: var(--shadow-sm);
}
.btn:active { transform: translateY(0) scale(0.98); }
.btn:disabled { opacity: 0.5; cursor: not-allowed; }

/* =========================================
   FLOATING INPUT COMPOSER
   ========================================= */
.composer {
  /* Membuat input melayang terpisah dari background */
  padding: 10px 14px;
  background: transparent; 
  display: flex; gap: 8px;
  position: relative;
}
/* Latar belakang blur di belakang area input saja */
.composer::before {
  content: '';
  position: absolute;
  inset: 0;
  background: var(--panel-glass);
  backdrop-filter: blur(var(--blur-strength));
  -webkit-backdrop-filter: blur(var(--blur-strength));
  border-top: 1px solid var(--border);
  z-index: -1;
}

.composer input {
  flex: 1;
  padding: 10px 16px;
  border-radius: 999px; /* Input berbentuk kapsul */
  border: 1px solid var(--border);
  background: rgba(255, 255, 255, 0.05); /* Sedikit transparan */
  color: var(--text);
  outline: none;
  font-size: 16px; /* Mencegah zoom di iOS */
  transition: all 0.2s;
  box-shadow: inset 0 1px 4px rgba(0,0,0,0.05);
}
:root[data-theme="light"] .composer input {
    background: rgba(0, 0, 0, 0.03);
}

.composer input:focus {
  border-color: var(--primary);
  background: var(--bg); /* Menjadi solid saat fokus */
  box-shadow: 0 0 0 3px var(--primary-soft);
}
.composer input::placeholder { color: var(--muted); opacity: 0.7; }

.composer button {
  padding: 0 16px;
  border-radius: 999px;
  border: none;
  background: var(--primary);
  color: white;
  cursor: pointer;
  font-weight: 600; 
  font-size: 14px;
  transition: all 0.2s;
  box-shadow: var(--shadow-sm);
}
.composer button:hover {
  filter: brightness(110%);
  transform: translateY(-1px);
  box-shadow: var(--shadow-md);
}
.composer button:active { transform: translateY(0) scale(0.97); }
.composer button:disabled, .composer input:disabled { opacity: 0.6; cursor: not-allowed; }

/* =========================================
   TYPING INDICATOR
   ========================================= */
.typing-bubble {
  background: var(--botBubbleBg);
  border: 1px solid var(--botBorder);
  border-radius: 20px;
  padding: 14px 18px;
  border-bottom-left-radius: 4px;
  box-shadow: var(--shadow-sm);
}
.typing { display: inline-flex; gap: 6px; align-items: center; }
.dot {
  width: 8px; height: 8px;
  border-radius: 50%;
  background: var(--muted);
  animation: premiumBounce 1.2s infinite ease-in-out both;
}
.dot:nth-child(1) { animation-delay: -0.32s; }
.dot:nth-child(2) { animation-delay: -0.16s; }
@keyframes premiumBounce {
  0%, 80%, 100% { transform: scale(0.6); opacity: 0.4; }
  40% { transform: scale(1); opacity: 1; }
}

/* =========================
   LIGHTBOX / IMAGE VIEWER (VERSI STABIL)
   ========================= */
.image-modal {
  /* Keadaan Tertutup (Default) */
  position: fixed;
  z-index: 9999;
  left: 0; top: 0;
  width: 100%; height: 100%;
  background-color: rgba(0, 0, 0, 0.95); /* Latar belakang gelap */
  backdrop-filter: blur(5px);
  
  display: flex;
  align-items: center;
  justify-content: center;
  
  /* Trik menyembunyikan tanpa display:none agar transisi mulus */
  opacity: 0;
  visibility: hidden; 
  transition: all 0.3s ease-in-out;
}

/* Keadaan Terbuka (Saat class .active ditambahkan) */
.image-modal.active {
  opacity: 1;
  visibility: visible;
}

.modal-content {
  max-width: 90%;
  max-height: 85%;
  border-radius: 8px;
  box-shadow: 0 10px 30px rgba(0,0,0,0.5);
  
  /* Animasi Zoom */
  transform: scale(0.8);
  transition: transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1); /* Efek membal sedikit */
}

.image-modal.active .modal-content {
  transform: scale(1);
}

/* =========================
   UPDATE: PREMIUM CLOSE BUTTON (SVG)
   ========================= */
.close-btn {

  border: none;
  background: transparent;
  padding: 0;

  position: absolute;
  top: max(20px, env(safe-area-inset-top) + 20px);
  right: 25px;
  z-index: 10001;

  width: 44px; 
  height: 44px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 50%; 

  color: rgba(255, 255, 255, 0.8); 
  cursor: pointer;

  transition: all 0.2s ease;
  
  -webkit-tap-highlight-color: transparent;
}

.close-btn svg {
  width: 28px; 
  height: 28px;
  stroke-width: 2.5;
}

.close-btn:hover {
  color: #ffffff;
  background-color: rgba(255, 255, 255, 0.15);
}

.close-btn:active {
  background-color: rgba(255, 255, 255, 0.25); 
  transform: scale(0.92);
}